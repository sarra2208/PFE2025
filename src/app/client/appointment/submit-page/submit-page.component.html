<div class="container mt-5" #more>
    @defer(on viewport(more)) { 
        
         
                <div class="card request-card shadow-lg p-3 mb-5  rounded">
                 
                    <div class="card-body px-2 py-1 ">
                        <div class="d-flex flex-wrap gap-2 align-items-center mb-2 p-3 rounded-3  ">
                          <div class="d-flex flex-grow-1 align-items-center me-3 min-w-0  shadow-sm p-3 mb-5  rounded">
                            <mat-icon class="compact-icon me-1">assignment</mat-icon>
                            <div class="text-truncate  ">
                              <div class="mat-caption text-secondary">SERVICE </div>
                              <div class="mat-body-2">{{ serviceName || selectedServiceId }}</div>
                            </div>
                          </div>
                      
                          <div class="d-flex flex-grow-1 align-items-center me-3 min-w-0  shadow-sm p-3 mb-5  rounded ">
                            <mat-icon class="compact-icon me-1">badge</mat-icon>
                            <div class="text-truncate">
                              <div class="mat-caption text-secondary">STAFF </div>
                              <div class="mat-body-2">{{ staffName || selectedEmployeeId }}</div>
                            </div>
                          </div>
                      
                          <div class="d-flex flex-grow-1 align-items-center min-w-0  shadow-sm p-3 mb-5  rounded">
                            <mat-icon class="compact-icon me-1">event</mat-icon>
                            <div class="text-truncate">
                              <div class="mat-caption text-secondary">DATE</div>
                              <div class="mat-body-2">
                                {{ selectedDate ? (selectedDate | date: "short") : '-' }}
                              </div>
                            </div>
                          </div>
                        </div>
                    
                      
                        <div class="form-section mt-4">
                            <mat-form-field appearance="outline" class="w-100">
                                <mat-label>Request Type</mat-label>
                                <mat-select [(ngModel)]="selectedType" required>
                                    @for (type of types; track type) {
                                        <mat-option [value]="type">{{ type }}</mat-option>
                                    }
                                </mat-select>
                                <mat-icon matSuffix>keyboard_arrow_down</mat-icon>
                            </mat-form-field>

                            <mat-form-field appearance="outline" class="w-100 mt-3">
                                <mat-label>Description</mat-label>
                                <textarea matInput [(ngModel)]="description" 
                                        rows="4" 
                                        placeholder="Enter request details..."></textarea>
                                <mat-icon matSuffix>description</mat-icon>
                            </mat-form-field>
                        </div>

                        <div class="status-container mt-4">
                            <div class="d-flex align-items-center gap-2">
                                <mat-icon class="text-muted">info</mat-icon>
                                <div>
                                    <div class="mat-caption text-secondary">STATUS</div>
                                    <div class="status-badge" [class]="getStatusClass(status)">
                                        {{status}}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="submit-section mt-5">
                            <button mat-raised-button color="primary" (click)="submitRequest()"
                                    class="submit-button">
                                <mat-icon class="me-2">send</mat-icon>
                                Submit Request
                            </button>
                        </div>
                    </div>
                </div>
         
      
    }
    @placeholder {
        <div class="text-center py-5">
            <mat-spinner diameter="50"></mat-spinner>
            <h1 class="mt-3 mat-subtitle-1">Loading request form...</h1>
        </div>
    }
    @error {
        <div class="alert alert-danger text-center">
            <mat-icon>error_outline</mat-icon>
            <h1 class="mat-subtitle-1">Failed to load form data</h1>
            <button mat-button color="warn" (click)="retryLoading()">Retry</button>
        </div>
    }
</div>